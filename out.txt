KeywordPackage
Identifier (socks5)
KeywordImport
Punctuation (()
Literal ("fmt")
Literal ("io")
Literal ("net")
Literal ("strconv")
Literal ("strings")
Literal ("golang.org/x/net/context")
Punctuation ())
KeywordConst
Punctuation (()
Identifier (ConnectCommand)
Operator (=)
Identifier (uint8)
Punctuation (()
Literal (1)
Punctuation ())
Identifier (BindCommand)
Operator (=)
Identifier (uint8)
Punctuation (()
Literal (2)
Punctuation ())
Identifier (AssociateCommand)
Operator (=)
Identifier (uint8)
Punctuation (()
Literal (3)
Punctuation ())
Identifier (ipv4Address)
Operator (=)
Identifier (uint8)
Punctuation (()
Literal (1)
Punctuation ())
Identifier (fqdnAddress)
Operator (=)
Identifier (uint8)
Punctuation (()
Literal (3)
Punctuation ())
Identifier (ipv6Address)
Operator (=)
Identifier (uint8)
Punctuation (()
Literal (4)
Punctuation ())
Punctuation ())
KeywordConst
Punctuation (()
Identifier (successReply)
Identifier (uint8)
Operator (=)
Identifier (iota)
Identifier (serverFailure)
Identifier (ruleFailure)
Identifier (networkUnreachable)
Identifier (hostUnreachable)
Identifier (connectionRefused)
Identifier (ttlExpired)
Identifier (commandNotSupported)
Identifier (addrTypeNotSupported)
Punctuation ())
KeywordVar
Punctuation (()
Identifier (unrecognizedAddrType)
Operator (=)
Identifier (fmt)
Operator (.)
Identifier (Errorf)
Punctuation (()
Literal ("Unrecognized address type")
Punctuation ())
Punctuation ())
Comment (// AddressRewriter is used to rewrite a destination transparently\n)
KeywordType
Identifier (AddressRewriter)
KeywordInterface
Punctuation ({)
Identifier (Rewrite)
Punctuation (()
Identifier (ctx)
Identifier (context)
Operator (.)
Identifier (Context)
Punctuation (,)
Identifier (request)
Operator (*)
Identifier (Request)
Punctuation ())
Punctuation (()
Identifier (context)
Operator (.)
Identifier (Context)
Punctuation (,)
Operator (*)
Identifier (AddrSpec)
Punctuation ())
Punctuation (})
Comment (// AddrSpec is used to return the target AddrSpec\n)
Comment (// which may be specified as IPv4, IPv6, or a FQDN\n)
KeywordType
Identifier (AddrSpec)
KeywordStruct
Punctuation ({)
Identifier (FQDN)
Identifier (string)
Identifier (IP)
Identifier (net)
Operator (.)
Identifier (IP)
Identifier (Port)
Identifier (int)
Punctuation (})
KeywordFunc
Punctuation (()
Identifier (a)
Operator (*)
Identifier (AddrSpec)
Punctuation ())
Identifier (String)
Punctuation (()
Punctuation ())
Identifier (string)
Punctuation ({)
KeywordIf
Identifier (a)
Operator (.)
Identifier (FQDN)
Operator (!=)
Literal ("")
Punctuation ({)
KeywordReturn
Identifier (fmt)
Operator (.)
Identifier (Sprintf)
Punctuation (()
Literal ("%s (%s):%d")
Punctuation (,)
Identifier (a)
Operator (.)
Identifier (FQDN)
Punctuation (,)
Identifier (a)
Operator (.)
Identifier (IP)
Punctuation (,)
Identifier (a)
Operator (.)
Identifier (Port)
Punctuation ())
Punctuation (})
KeywordReturn
Identifier (fmt)
Operator (.)
Identifier (Sprintf)
Punctuation (()
Literal ("%s:%d")
Punctuation (,)
Identifier (a)
Operator (.)
Identifier (IP)
Punctuation (,)
Identifier (a)
Operator (.)
Identifier (Port)
Punctuation ())
Punctuation (})
Comment (// Address returns a string suitable to dial; prefer returning IP-based\n)
Comment (// address, fallback to FQDN\n)
KeywordFunc
Punctuation (()
Identifier (a)
Identifier (AddrSpec)
Punctuation ())
Identifier (Address)
Punctuation (()
Punctuation ())
Identifier (string)
Punctuation ({)
KeywordIf
Literal (0)
Operator (!=)
Identifier (len)
Punctuation (()
Identifier (a)
Operator (.)
Identifier (IP)
Punctuation ())
Punctuation ({)
KeywordReturn
Identifier (net)
Operator (.)
Identifier (JoinHostPort)
Punctuation (()
Identifier (a)
Operator (.)
Identifier (IP)
Operator (.)
Identifier (String)
Punctuation (()
Punctuation ())
Punctuation (,)
Identifier (strconv)
Operator (.)
Identifier (Itoa)
Punctuation (()
Identifier (a)
Operator (.)
Identifier (Port)
Punctuation ())
Punctuation ())
Punctuation (})
KeywordReturn
Identifier (net)
Operator (.)
Identifier (JoinHostPort)
Punctuation (()
Identifier (a)
Operator (.)
Identifier (FQDN)
Punctuation (,)
Identifier (strconv)
Operator (.)
Identifier (Itoa)
Punctuation (()
Identifier (a)
Operator (.)
Identifier (Port)
Punctuation ())
Punctuation ())
Punctuation (})
Comment (// A Request represents request received by a server\n)
KeywordType
Identifier (Request)
KeywordStruct
Punctuation ({)
Comment (// Protocol version\n)
Identifier (Version)
Identifier (uint8)
Comment (// Requested command\n)
Identifier (Command)
Identifier (uint8)
Comment (// AuthContext provided during negotiation\n)
Identifier (AuthContext)
Operator (*)
Identifier (AuthContext)
Comment (// AddrSpec of the the network that sent the request\n)
Identifier (RemoteAddr)
Operator (*)
Identifier (AddrSpec)
Comment (// AddrSpec of the desired destination\n)
Identifier (DestAddr)
Operator (*)
Identifier (AddrSpec)
Comment (// AddrSpec of the actual destination (might be affected by rewrite)\n)
Identifier (realDestAddr)
Operator (*)
Identifier (AddrSpec)
Identifier (bufConn)
Identifier (io)
Operator (.)
Identifier (Reader)
Punctuation (})
KeywordType
Identifier (conn)
KeywordInterface
Punctuation ({)
Identifier (Write)
Punctuation (()
Punctuation ([)
Punctuation (])
Identifier (byte)
Punctuation ())
Punctuation (()
Identifier (int)
Punctuation (,)
Identifier (error)
Punctuation ())
Identifier (RemoteAddr)
Punctuation (()
Punctuation ())
Identifier (net)
Operator (.)
Identifier (Addr)
Punctuation (})
Comment (// NewRequest creates a new Request from the tcp connection\n)
KeywordFunc
Identifier (NewRequest)
Punctuation (()
Identifier (bufConn)
Identifier (io)
Operator (.)
Identifier (Reader)
Punctuation ())
Punctuation (()
Operator (*)
Identifier (Request)
Punctuation (,)
Identifier (error)
Punctuation ())
Punctuation ({)
Comment (// Read the version byte\n)
Identifier (header)
Operator (:=)
Punctuation ([)
Punctuation (])
Identifier (byte)
Punctuation ({)
Literal (0)
Punctuation (,)
Literal (0)
Punctuation (,)
Literal (0)
Punctuation (})
KeywordIf
Identifier (_)
Punctuation (,)
Identifier (err)
Operator (:=)
Identifier (io)
Operator (.)
Identifier (ReadAtLeast)
Punctuation (()
Identifier (bufConn)
Punctuation (,)
Identifier (header)
Punctuation (,)
Literal (3)
Punctuation ())
Punctuation (;)
Identifier (err)
Operator (!=)
Identifier (nil)
Punctuation ({)
KeywordReturn
Identifier (nil)
Punctuation (,)
Identifier (fmt)
Operator (.)
Identifier (Errorf)
Punctuation (()
Literal ("Failed to get command version: %v")
Punctuation (,)
Identifier (err)
Punctuation ())
Punctuation (})
Comment (// Ensure we are compatible\n)
KeywordIf
Identifier (header)
Punctuation ([)
Literal (0)
Punctuation (])
Operator (!=)
Identifier (socks5Version)
Punctuation ({)
KeywordReturn
Identifier (nil)
Punctuation (,)
Identifier (fmt)
Operator (.)
Identifier (Errorf)
Punctuation (()
Literal ("Unsupported command version: %v")
Punctuation (,)
Identifier (header)
Punctuation ([)
Literal (0)
Punctuation (])
Punctuation ())
Punctuation (})
Comment (// Read in the destination address\n)
Identifier (dest)
Punctuation (,)
Identifier (err)
Operator (:=)
Identifier (readAddrSpec)
Punctuation (()
Identifier (bufConn)
Punctuation ())
KeywordIf
Identifier (err)
Operator (!=)
Identifier (nil)
Punctuation ({)
KeywordReturn
Identifier (nil)
Punctuation (,)
Identifier (err)
Punctuation (})
Identifier (request)
Operator (:=)
Operator (&)
Identifier (Request)
Punctuation ({)
Identifier (Version)
Operator (:)
Identifier (socks5Version)
Punctuation (,)
Identifier (Command)
Operator (:)
Identifier (header)
Punctuation ([)
Literal (1)
Punctuation (])
Punctuation (,)
Identifier (DestAddr)
Operator (:)
Identifier (dest)
Punctuation (,)
Identifier (bufConn)
Operator (:)
Identifier (bufConn)
Punctuation (,)
Punctuation (})
KeywordReturn
Identifier (request)
Punctuation (,)
Identifier (nil)
Punctuation (})
Comment (// handleRequest is used for request processing after authentication\n)
KeywordFunc
Punctuation (()
Identifier (s)
Operator (*)
Identifier (Server)
Punctuation ())
Identifier (handleRequest)
Punctuation (()
Identifier (req)
Operator (*)
Identifier (Request)
Punctuation (,)
Identifier (conn)
Identifier (conn)
Punctuation ())
Identifier (error)
Punctuation ({)
Identifier (ctx)
Operator (:=)
Identifier (context)
Operator (.)
Identifier (Background)
Punctuation (()
Punctuation ())
Comment (// Resolve the address if we have a FQDN\n)
Identifier (dest)
Operator (:=)
Identifier (req)
Operator (.)
Identifier (DestAddr)
KeywordIf
Identifier (dest)
Operator (.)
Identifier (FQDN)
Operator (!=)
Literal ("")
Punctuation ({)
Identifier (ctx_)
Punctuation (,)
Identifier (addr)
Punctuation (,)
Identifier (err)
Operator (:=)
Identifier (s)
Operator (.)
Identifier (config)
Operator (.)
Identifier (Resolver)
Operator (.)
Identifier (Resolve)
Punctuation (()
Identifier (ctx)
Punctuation (,)
Identifier (dest)
Operator (.)
Identifier (FQDN)
Punctuation ())
KeywordIf
Identifier (err)
Operator (!=)
Identifier (nil)
Punctuation ({)
KeywordIf
Identifier (err)
Operator (:=)
Identifier (sendReply)
Punctuation (()
Identifier (conn)
Punctuation (,)
Identifier (hostUnreachable)
Punctuation (,)
Identifier (nil)
Punctuation ())
Punctuation (;)
Identifier (err)
Operator (!=)
Identifier (nil)
Punctuation ({)
KeywordReturn
Identifier (fmt)
Operator (.)
Identifier (Errorf)
Punctuation (()
Literal ("Failed to send reply: %v")
Punctuation (,)
Identifier (err)
Punctuation ())
Punctuation (})
KeywordReturn
Identifier (fmt)
Operator (.)
Identifier (Errorf)
Punctuation (()
Literal ("Failed to resolve destination '%v': %v")
Punctuation (,)
Identifier (dest)
Operator (.)
Identifier (FQDN)
Punctuation (,)
Identifier (err)
Punctuation ())
Punctuation (})
Identifier (ctx)
Operator (=)
Identifier (ctx_)
Identifier (dest)
Operator (.)
Identifier (IP)
Operator (=)
Identifier (addr)
Punctuation (})
Comment (// Apply any address rewrites\n)
Identifier (req)
Operator (.)
Identifier (realDestAddr)
Operator (=)
Identifier (req)
Operator (.)
Identifier (DestAddr)
KeywordIf
Identifier (s)
Operator (.)
Identifier (config)
Operator (.)
Identifier (Rewriter)
Operator (!=)
Identifier (nil)
Punctuation ({)
Identifier (ctx)
Punctuation (,)
Identifier (req)
Operator (.)
Identifier (realDestAddr)
Operator (=)
Identifier (s)
Operator (.)
Identifier (config)
Operator (.)
Identifier (Rewriter)
Operator (.)
Identifier (Rewrite)
Punctuation (()
Identifier (ctx)
Punctuation (,)
Identifier (req)
Punctuation ())
Punctuation (})
Comment (// Switch on the command\n)
KeywordSwitch
Identifier (req)
Operator (.)
Identifier (Command)
Punctuation ({)
KeywordCase
Identifier (ConnectCommand)
Operator (:)
KeywordReturn
Identifier (s)
Operator (.)
Identifier (handleConnect)
Punctuation (()
Identifier (ctx)
Punctuation (,)
Identifier (conn)
Punctuation (,)
Identifier (req)
Punctuation ())
KeywordCase
Identifier (BindCommand)
Operator (:)
KeywordReturn
Identifier (s)
Operator (.)
Identifier (handleBind)
Punctuation (()
Identifier (ctx)
Punctuation (,)
Identifier (conn)
Punctuation (,)
Identifier (req)
Punctuation ())
KeywordCase
Identifier (AssociateCommand)
Operator (:)
KeywordReturn
Identifier (s)
Operator (.)
Identifier (handleAssociate)
Punctuation (()
Identifier (ctx)
Punctuation (,)
Identifier (conn)
Punctuation (,)
Identifier (req)
Punctuation ())
KeywordDefault
Operator (:)
KeywordIf
Identifier (err)
Operator (:=)
Identifier (sendReply)
Punctuation (()
Identifier (conn)
Punctuation (,)
Identifier (commandNotSupported)
Punctuation (,)
Identifier (nil)
Punctuation ())
Punctuation (;)
Identifier (err)
Operator (!=)
Identifier (nil)
Punctuation ({)
KeywordReturn
Identifier (fmt)
Operator (.)
Identifier (Errorf)
Punctuation (()
Literal ("Failed to send reply: %v")
Punctuation (,)
Identifier (err)
Punctuation ())
Punctuation (})
KeywordReturn
Identifier (fmt)
Operator (.)
Identifier (Errorf)
Punctuation (()
Literal ("Unsupported command: %v")
Punctuation (,)
Identifier (req)
Operator (.)
Identifier (Command)
Punctuation ())
Punctuation (})
Punctuation (})
Comment (// handleConnect is used to handle a connect command\n)
KeywordFunc
Punctuation (()
Identifier (s)
Operator (*)
Identifier (Server)
Punctuation ())
Identifier (handleConnect)
Punctuation (()
Identifier (ctx)
Identifier (context)
Operator (.)
Identifier (Context)
Punctuation (,)
Identifier (conn)
Identifier (conn)
Punctuation (,)
Identifier (req)
Operator (*)
Identifier (Request)
Punctuation ())
Identifier (error)
Punctuation ({)
Comment (// Check if this is allowed\n)
KeywordIf
Identifier (ctx_)
Punctuation (,)
Identifier (ok)
Operator (:=)
Identifier (s)
Operator (.)
Identifier (config)
Operator (.)
Identifier (Rules)
Operator (.)
Identifier (Allow)
Punctuation (()
Identifier (ctx)
Punctuation (,)
Identifier (req)
Punctuation ())
Punctuation (;)
Operator (!)
Identifier (ok)
Punctuation ({)
KeywordIf
Identifier (err)
Operator (:=)
Identifier (sendReply)
Punctuation (()
Identifier (conn)
Punctuation (,)
Identifier (ruleFailure)
Punctuation (,)
Identifier (nil)
Punctuation ())
Punctuation (;)
Identifier (err)
Operator (!=)
Identifier (nil)
Punctuation ({)
KeywordReturn
Identifier (fmt)
Operator (.)
Identifier (Errorf)
Punctuation (()
Literal ("Failed to send reply: %v")
Punctuation (,)
Identifier (err)
Punctuation ())
Punctuation (})
KeywordReturn
Identifier (fmt)
Operator (.)
Identifier (Errorf)
Punctuation (()
Literal ("Connect to %v blocked by rules")
Punctuation (,)
Identifier (req)
Operator (.)
Identifier (DestAddr)
Punctuation ())
Punctuation (})
KeywordElse
Punctuation ({)
Identifier (ctx)
Operator (=)
Identifier (ctx_)
Punctuation (})
Comment (// Attempt to connect\n)
Identifier (dial)
Operator (:=)
Identifier (s)
Operator (.)
Identifier (config)
Operator (.)
Identifier (Dial)
KeywordIf
Identifier (dial)
Operator (==)
Identifier (nil)
Punctuation ({)
Identifier (dial)
Operator (=)
KeywordFunc
Punctuation (()
Identifier (ctx)
Identifier (context)
Operator (.)
Identifier (Context)
Punctuation (,)
Identifier (net_)
Punctuation (,)
Identifier (addr)
Identifier (string)
Punctuation ())
Punctuation (()
Identifier (net)
Operator (.)
Identifier (Conn)
Punctuation (,)
Identifier (error)
Punctuation ())
Punctuation ({)
KeywordReturn
Identifier (net)
Operator (.)
Identifier (Dial)
Punctuation (()
Identifier (net_)
Punctuation (,)
Identifier (addr)
Punctuation ())
Punctuation (})
Punctuation (})
Identifier (target)
Punctuation (,)
Identifier (err)
Operator (:=)
Identifier (dial)
Punctuation (()
Identifier (ctx)
Punctuation (,)
Literal ("tcp")
Punctuation (,)
Identifier (req)
Operator (.)
Identifier (realDestAddr)
Operator (.)
Identifier (Address)
Punctuation (()
Punctuation ())
Punctuation ())
KeywordIf
Identifier (err)
Operator (!=)
Identifier (nil)
Punctuation ({)
Identifier (msg)
Operator (:=)
Identifier (err)
Operator (.)
Identifier (Error)
Punctuation (()
Punctuation ())
Identifier (resp)
Operator (:=)
Identifier (hostUnreachable)
KeywordIf
Identifier (strings)
Operator (.)
Identifier (Contains)
Punctuation (()
Identifier (msg)
Punctuation (,)
Literal ("refused")
Punctuation ())
Punctuation ({)
Identifier (resp)
Operator (=)
Identifier (connectionRefused)
Punctuation (})
KeywordElse
KeywordIf
Identifier (strings)
Operator (.)
Identifier (Contains)
Punctuation (()
Identifier (msg)
Punctuation (,)
Literal ("network is unreachable")
Punctuation ())
Punctuation ({)
Identifier (resp)
Operator (=)
Identifier (networkUnreachable)
Punctuation (})
KeywordIf
Identifier (err)
Operator (:=)
Identifier (sendReply)
Punctuation (()
Identifier (conn)
Punctuation (,)
Identifier (resp)
Punctuation (,)
Identifier (nil)
Punctuation ())
Punctuation (;)
Identifier (err)
Operator (!=)
Identifier (nil)
Punctuation ({)
KeywordReturn
Identifier (fmt)
Operator (.)
Identifier (Errorf)
Punctuation (()
Literal ("Failed to send reply: %v")
Punctuation (,)
Identifier (err)
Punctuation ())
Punctuation (})
KeywordReturn
Identifier (fmt)
Operator (.)
Identifier (Errorf)
Punctuation (()
Literal ("Connect to %v failed: %v")
Punctuation (,)
Identifier (req)
Operator (.)
Identifier (DestAddr)
Punctuation (,)
Identifier (err)
Punctuation ())
Punctuation (})
KeywordDefer
Identifier (target)
Operator (.)
Identifier (Close)
Punctuation (()
Punctuation ())
Comment (// Send success\n)
Identifier (local)
Operator (:=)
Identifier (target)
Operator (.)
Identifier (LocalAddr)
Punctuation (()
Punctuation ())
Operator (.)
Punctuation (()
Operator (*)
Identifier (net)
Operator (.)
Identifier (TCPAddr)
Punctuation ())
Identifier (bind)
Operator (:=)
Identifier (AddrSpec)
Punctuation ({)
Identifier (IP)
Operator (:)
Identifier (local)
Operator (.)
Identifier (IP)
Punctuation (,)
Identifier (Port)
Operator (:)
Identifier (local)
Operator (.)
Identifier (Port)
Punctuation (})
KeywordIf
Identifier (err)
Operator (:=)
Identifier (sendReply)
Punctuation (()
Identifier (conn)
Punctuation (,)
Identifier (successReply)
Punctuation (,)
Operator (&)
Identifier (bind)
Punctuation ())
Punctuation (;)
Identifier (err)
Operator (!=)
Identifier (nil)
Punctuation ({)
KeywordReturn
Identifier (fmt)
Operator (.)
Identifier (Errorf)
Punctuation (()
Literal ("Failed to send reply: %v")
Punctuation (,)
Identifier (err)
Punctuation ())
Punctuation (})
Comment (// Start proxying\n)
Identifier (errCh)
Operator (:=)
Identifier (make)
Punctuation (()
KeywordChan
Identifier (error)
Punctuation (,)
Literal (2)
Punctuation ())
KeywordGo
Identifier (proxy)
Punctuation (()
Identifier (target)
Punctuation (,)
Identifier (req)
Operator (.)
Identifier (bufConn)
Punctuation (,)
Identifier (errCh)
Punctuation ())
KeywordGo
Identifier (proxy)
Punctuation (()
Identifier (conn)
Punctuation (,)
Identifier (target)
Punctuation (,)
Identifier (errCh)
Punctuation ())
Comment (// Wait\n)
KeywordFor
Identifier (i)
Operator (:=)
Literal (0)
Punctuation (;)
Identifier (i)
Operator (<)
Literal (2)
Punctuation (;)
Identifier (i)
Operator (++)
Punctuation ({)
Identifier (e)
Operator (:=)
Operator (<-)
Identifier (errCh)
KeywordIf
Identifier (e)
Operator (!=)
Identifier (nil)
Punctuation ({)
Comment (// return from this function closes target (and conn).\n)
KeywordReturn
Identifier (e)
Punctuation (})
Punctuation (})
KeywordReturn
Identifier (nil)
Punctuation (})
Comment (// handleBind is used to handle a connect command\n)
KeywordFunc
Punctuation (()
Identifier (s)
Operator (*)
Identifier (Server)
Punctuation ())
Identifier (handleBind)
Punctuation (()
Identifier (ctx)
Identifier (context)
Operator (.)
Identifier (Context)
Punctuation (,)
Identifier (conn)
Identifier (conn)
Punctuation (,)
Identifier (req)
Operator (*)
Identifier (Request)
Punctuation ())
Identifier (error)
Punctuation ({)
Comment (// Check if this is allowed\n)
KeywordIf
Identifier (ctx_)
Punctuation (,)
Identifier (ok)
Operator (:=)
Identifier (s)
Operator (.)
Identifier (config)
Operator (.)
Identifier (Rules)
Operator (.)
Identifier (Allow)
Punctuation (()
Identifier (ctx)
Punctuation (,)
Identifier (req)
Punctuation ())
Punctuation (;)
Operator (!)
Identifier (ok)
Punctuation ({)
KeywordIf
Identifier (err)
Operator (:=)
Identifier (sendReply)
Punctuation (()
Identifier (conn)
Punctuation (,)
Identifier (ruleFailure)
Punctuation (,)
Identifier (nil)
Punctuation ())
Punctuation (;)
Identifier (err)
Operator (!=)
Identifier (nil)
Punctuation ({)
KeywordReturn
Identifier (fmt)
Operator (.)
Identifier (Errorf)
Punctuation (()
Literal ("Failed to send reply: %v")
Punctuation (,)
Identifier (err)
Punctuation ())
Punctuation (})
KeywordReturn
Identifier (fmt)
Operator (.)
Identifier (Errorf)
Punctuation (()
Literal ("Bind to %v blocked by rules")
Punctuation (,)
Identifier (req)
Operator (.)
Identifier (DestAddr)
Punctuation ())
Punctuation (})
KeywordElse
Punctuation ({)
Identifier (ctx)
Operator (=)
Identifier (ctx_)
Punctuation (})
Comment (// TODO: Support bind\n)
KeywordIf
Identifier (err)
Operator (:=)
Identifier (sendReply)
Punctuation (()
Identifier (conn)
Punctuation (,)
Identifier (commandNotSupported)
Punctuation (,)
Identifier (nil)
Punctuation ())
Punctuation (;)
Identifier (err)
Operator (!=)
Identifier (nil)
Punctuation ({)
KeywordReturn
Identifier (fmt)
Operator (.)
Identifier (Errorf)
Punctuation (()
Literal ("Failed to send reply: %v")
Punctuation (,)
Identifier (err)
Punctuation ())
Punctuation (})
KeywordReturn
Identifier (nil)
Punctuation (})
Comment (// handleAssociate is used to handle a connect command\n)
KeywordFunc
Punctuation (()
Identifier (s)
Operator (*)
Identifier (Server)
Punctuation ())
Identifier (handleAssociate)
Punctuation (()
Identifier (ctx)
Identifier (context)
Operator (.)
Identifier (Context)
Punctuation (,)
Identifier (conn)
Identifier (conn)
Punctuation (,)
Identifier (req)
Operator (*)
Identifier (Request)
Punctuation ())
Identifier (error)
Punctuation ({)
Comment (// Check if this is allowed\n)
KeywordIf
Identifier (ctx_)
Punctuation (,)
Identifier (ok)
Operator (:=)
Identifier (s)
Operator (.)
Identifier (config)
Operator (.)
Identifier (Rules)
Operator (.)
Identifier (Allow)
Punctuation (()
Identifier (ctx)
Punctuation (,)
Identifier (req)
Punctuation ())
Punctuation (;)
Operator (!)
Identifier (ok)
Punctuation ({)
KeywordIf
Identifier (err)
Operator (:=)
Identifier (sendReply)
Punctuation (()
Identifier (conn)
Punctuation (,)
Identifier (ruleFailure)
Punctuation (,)
Identifier (nil)
Punctuation ())
Punctuation (;)
Identifier (err)
Operator (!=)
Identifier (nil)
Punctuation ({)
KeywordReturn
Identifier (fmt)
Operator (.)
Identifier (Errorf)
Punctuation (()
Literal ("Failed to send reply: %v")
Punctuation (,)
Identifier (err)
Punctuation ())
Punctuation (})
KeywordReturn
Identifier (fmt)
Operator (.)
Identifier (Errorf)
Punctuation (()
Literal ("Associate to %v blocked by rules")
Punctuation (,)
Identifier (req)
Operator (.)
Identifier (DestAddr)
Punctuation ())
Punctuation (})
KeywordElse
Punctuation ({)
Identifier (ctx)
Operator (=)
Identifier (ctx_)
Punctuation (})
Comment (// TODO: Support associate\n)
KeywordIf
Identifier (err)
Operator (:=)
Identifier (sendReply)
Punctuation (()
Identifier (conn)
Punctuation (,)
Identifier (commandNotSupported)
Punctuation (,)
Identifier (nil)
Punctuation ())
Punctuation (;)
Identifier (err)
Operator (!=)
Identifier (nil)
Punctuation ({)
KeywordReturn
Identifier (fmt)
Operator (.)
Identifier (Errorf)
Punctuation (()
Literal ("Failed to send reply: %v")
Punctuation (,)
Identifier (err)
Punctuation ())
Punctuation (})
KeywordReturn
Identifier (nil)
Punctuation (})
Comment (// readAddrSpec is used to read AddrSpec.\n)
Comment (// Expects an address type byte, follwed by the address and port\n)
KeywordFunc
Identifier (readAddrSpec)
Punctuation (()
Identifier (r)
Identifier (io)
Operator (.)
Identifier (Reader)
Punctuation ())
Punctuation (()
Operator (*)
Identifier (AddrSpec)
Punctuation (,)
Identifier (error)
Punctuation ())
Punctuation ({)
Identifier (d)
Operator (:=)
Operator (&)
Identifier (AddrSpec)
Punctuation ({)
Punctuation (})
Comment (// Get the address type\n)
Identifier (addrType)
Operator (:=)
Punctuation ([)
Punctuation (])
Identifier (byte)
Punctuation ({)
Literal (0)
Punctuation (})
KeywordIf
Identifier (_)
Punctuation (,)
Identifier (err)
Operator (:=)
Identifier (r)
Operator (.)
Identifier (Read)
Punctuation (()
Identifier (addrType)
Punctuation ())
Punctuation (;)
Identifier (err)
Operator (!=)
Identifier (nil)
Punctuation ({)
KeywordReturn
Identifier (nil)
Punctuation (,)
Identifier (err)
Punctuation (})
Comment (// Handle on a per type basis\n)
KeywordSwitch
Identifier (addrType)
Punctuation ([)
Literal (0)
Punctuation (])
Punctuation ({)
KeywordCase
Identifier (ipv4Address)
Operator (:)
Identifier (addr)
Operator (:=)
Identifier (make)
Punctuation (()
Punctuation ([)
Punctuation (])
Identifier (byte)
Punctuation (,)
Literal (4)
Punctuation ())
KeywordIf
Identifier (_)
Punctuation (,)
Identifier (err)
Operator (:=)
Identifier (io)
Operator (.)
Identifier (ReadAtLeast)
Punctuation (()
Identifier (r)
Punctuation (,)
Identifier (addr)
Punctuation (,)
Identifier (len)
Punctuation (()
Identifier (addr)
Punctuation ())
Punctuation ())
Punctuation (;)
Identifier (err)
Operator (!=)
Identifier (nil)
Punctuation ({)
KeywordReturn
Identifier (nil)
Punctuation (,)
Identifier (err)
Punctuation (})
Identifier (d)
Operator (.)
Identifier (IP)
Operator (=)
Identifier (net)
Operator (.)
Identifier (IP)
Punctuation (()
Identifier (addr)
Punctuation ())
KeywordCase
Identifier (ipv6Address)
Operator (:)
Identifier (addr)
Operator (:=)
Identifier (make)
Punctuation (()
Punctuation ([)
Punctuation (])
Identifier (byte)
Punctuation (,)
Literal (16)
Punctuation ())
KeywordIf
Identifier (_)
Punctuation (,)
Identifier (err)
Operator (:=)
Identifier (io)
Operator (.)
Identifier (ReadAtLeast)
Punctuation (()
Identifier (r)
Punctuation (,)
Identifier (addr)
Punctuation (,)
Identifier (len)
Punctuation (()
Identifier (addr)
Punctuation ())
Punctuation ())
Punctuation (;)
Identifier (err)
Operator (!=)
Identifier (nil)
Punctuation ({)
KeywordReturn
Identifier (nil)
Punctuation (,)
Identifier (err)
Punctuation (})
Identifier (d)
Operator (.)
Identifier (IP)
Operator (=)
Identifier (net)
Operator (.)
Identifier (IP)
Punctuation (()
Identifier (addr)
Punctuation ())
KeywordCase
Identifier (fqdnAddress)
Operator (:)
KeywordIf
Identifier (_)
Punctuation (,)
Identifier (err)
Operator (:=)
Identifier (r)
Operator (.)
Identifier (Read)
Punctuation (()
Identifier (addrType)
Punctuation ())
Punctuation (;)
Identifier (err)
Operator (!=)
Identifier (nil)
Punctuation ({)
KeywordReturn
Identifier (nil)
Punctuation (,)
Identifier (err)
Punctuation (})
Identifier (addrLen)
Operator (:=)
Identifier (int)
Punctuation (()
Identifier (addrType)
Punctuation ([)
Literal (0)
Punctuation (])
Punctuation ())
Identifier (fqdn)
Operator (:=)
Identifier (make)
Punctuation (()
Punctuation ([)
Punctuation (])
Identifier (byte)
Punctuation (,)
Identifier (addrLen)
Punctuation ())
KeywordIf
Identifier (_)
Punctuation (,)
Identifier (err)
Operator (:=)
Identifier (io)
Operator (.)
Identifier (ReadAtLeast)
Punctuation (()
Identifier (r)
Punctuation (,)
Identifier (fqdn)
Punctuation (,)
Identifier (addrLen)
Punctuation ())
Punctuation (;)
Identifier (err)
Operator (!=)
Identifier (nil)
Punctuation ({)
KeywordReturn
Identifier (nil)
Punctuation (,)
Identifier (err)
Punctuation (})
Identifier (d)
Operator (.)
Identifier (FQDN)
Operator (=)
Identifier (string)
Punctuation (()
Identifier (fqdn)
Punctuation ())
KeywordDefault
Operator (:)
KeywordReturn
Identifier (nil)
Punctuation (,)
Identifier (unrecognizedAddrType)
Punctuation (})
Comment (// Read the port\n)
Identifier (port)
Operator (:=)
Punctuation ([)
Punctuation (])
Identifier (byte)
Punctuation ({)
Literal (0)
Punctuation (,)
Literal (0)
Punctuation (})
KeywordIf
Identifier (_)
Punctuation (,)
Identifier (err)
Operator (:=)
Identifier (io)
Operator (.)
Identifier (ReadAtLeast)
Punctuation (()
Identifier (r)
Punctuation (,)
Identifier (port)
Punctuation (,)
Literal (2)
Punctuation ())
Punctuation (;)
Identifier (err)
Operator (!=)
Identifier (nil)
Punctuation ({)
KeywordReturn
Identifier (nil)
Punctuation (,)
Identifier (err)
Punctuation (})
Identifier (d)
Operator (.)
Identifier (Port)
Operator (=)
Punctuation (()
Identifier (int)
Punctuation (()
Identifier (port)
Punctuation ([)
Literal (0)
Punctuation (])
Punctuation ())
Operator (<<)
Literal (8)
Punctuation ())
Operator (|)
Identifier (int)
Punctuation (()
Identifier (port)
Punctuation ([)
Literal (1)
Punctuation (])
Punctuation ())
KeywordReturn
Identifier (d)
Punctuation (,)
Identifier (nil)
Punctuation (})
Comment (// sendReply is used to send a reply message\n)
KeywordFunc
Identifier (sendReply)
Punctuation (()
Identifier (w)
Identifier (io)
Operator (.)
Identifier (Writer)
Punctuation (,)
Identifier (resp)
Identifier (uint8)
Punctuation (,)
Identifier (addr)
Operator (*)
Identifier (AddrSpec)
Punctuation ())
Identifier (error)
Punctuation ({)
Comment (// Format the address\n)
KeywordVar
Identifier (addrType)
Identifier (uint8)
KeywordVar
Identifier (addrBody)
Punctuation ([)
Punctuation (])
Identifier (byte)
KeywordVar
Identifier (addrPort)
Identifier (uint16)
KeywordSwitch
Punctuation ({)
KeywordCase
Identifier (addr)
Operator (==)
Identifier (nil)
Operator (:)
Identifier (addrType)
Operator (=)
Identifier (ipv4Address)
Identifier (addrBody)
Operator (=)
Punctuation ([)
Punctuation (])
Identifier (byte)
Punctuation ({)
Literal (0)
Punctuation (,)
Literal (0)
Punctuation (,)
Literal (0)
Punctuation (,)
Literal (0)
Punctuation (})
Identifier (addrPort)
Operator (=)
Literal (0)
KeywordCase
Identifier (addr)
Operator (.)
Identifier (FQDN)
Operator (!=)
Literal ("")
Operator (:)
Identifier (addrType)
Operator (=)
Identifier (fqdnAddress)
Identifier (addrBody)
Operator (=)
Identifier (append)
Punctuation (()
Punctuation ([)
Punctuation (])
Identifier (byte)
Punctuation ({)
Identifier (byte)
Punctuation (()
Identifier (len)
Punctuation (()
Identifier (addr)
Operator (.)
Identifier (FQDN)
Punctuation ())
Punctuation ())
Punctuation (})
Punctuation (,)
Identifier (addr)
Operator (.)
Identifier (FQDN)
Punctuation (...)
Punctuation ())
Identifier (addrPort)
Operator (=)
Identifier (uint16)
Punctuation (()
Identifier (addr)
Operator (.)
Identifier (Port)
Punctuation ())
KeywordCase
Identifier (addr)
Operator (.)
Identifier (IP)
Operator (.)
Identifier (To4)
Punctuation (()
Punctuation ())
Operator (!=)
Identifier (nil)
Operator (:)
Identifier (addrType)
Operator (=)
Identifier (ipv4Address)
Identifier (addrBody)
Operator (=)
Punctuation ([)
Punctuation (])
Identifier (byte)
Punctuation (()
Identifier (addr)
Operator (.)
Identifier (IP)
Operator (.)
Identifier (To4)
Punctuation (()
Punctuation ())
Punctuation ())
Identifier (addrPort)
Operator (=)
Identifier (uint16)
Punctuation (()
Identifier (addr)
Operator (.)
Identifier (Port)
Punctuation ())
KeywordCase
Identifier (addr)
Operator (.)
Identifier (IP)
Operator (.)
Identifier (To16)
Punctuation (()
Punctuation ())
Operator (!=)
Identifier (nil)
Operator (:)
Identifier (addrType)
Operator (=)
Identifier (ipv6Address)
Identifier (addrBody)
Operator (=)
Punctuation ([)
Punctuation (])
Identifier (byte)
Punctuation (()
Identifier (addr)
Operator (.)
Identifier (IP)
Operator (.)
Identifier (To16)
Punctuation (()
Punctuation ())
Punctuation ())
Identifier (addrPort)
Operator (=)
Identifier (uint16)
Punctuation (()
Identifier (addr)
Operator (.)
Identifier (Port)
Punctuation ())
KeywordDefault
Operator (:)
KeywordReturn
Identifier (fmt)
Operator (.)
Identifier (Errorf)
Punctuation (()
Literal ("Failed to format address: %v")
Punctuation (,)
Identifier (addr)
Punctuation ())
Punctuation (})
Comment (// Format the message\n)
Identifier (msg)
Operator (:=)
Identifier (make)
Punctuation (()
Punctuation ([)
Punctuation (])
Identifier (byte)
Punctuation (,)
Literal (6)
Operator (+)
Identifier (len)
Punctuation (()
Identifier (addrBody)
Punctuation ())
Punctuation ())
Identifier (msg)
Punctuation ([)
Literal (0)
Punctuation (])
Operator (=)
Identifier (socks5Version)
Identifier (msg)
Punctuation ([)
Literal (1)
Punctuation (])
Operator (=)
Identifier (resp)
Identifier (msg)
Punctuation ([)
Literal (2)
Punctuation (])
Operator (=)
Literal (0)
Comment (// Reserved\n)
Identifier (msg)
Punctuation ([)
Literal (3)
Punctuation (])
Operator (=)
Identifier (addrType)
Identifier (copy)
Punctuation (()
Identifier (msg)
Punctuation ([)
Literal (4)
Operator (:)
Punctuation (])
Punctuation (,)
Identifier (addrBody)
Punctuation ())
Identifier (msg)
Punctuation ([)
Literal (4)
Operator (+)
Identifier (len)
Punctuation (()
Identifier (addrBody)
Punctuation ())
Punctuation (])
Operator (=)
Identifier (byte)
Punctuation (()
Identifier (addrPort)
Operator (>>)
Literal (8)
Punctuation ())
Identifier (msg)
Punctuation ([)
Literal (4)
Operator (+)
Identifier (len)
Punctuation (()
Identifier (addrBody)
Punctuation ())
Operator (+)
Literal (1)
Punctuation (])
Operator (=)
Identifier (byte)
Punctuation (()
Identifier (addrPort)
Operator (&)
Literal (0xff)
Punctuation ())
Comment (// Send the message\n)
Identifier (_)
Punctuation (,)
Identifier (err)
Operator (:=)
Identifier (w)
Operator (.)
Identifier (Write)
Punctuation (()
Identifier (msg)
Punctuation ())
KeywordReturn
Identifier (err)
Punctuation (})
KeywordType
Identifier (closeWriter)
KeywordInterface
Punctuation ({)
Identifier (CloseWrite)
Punctuation (()
Punctuation ())
Identifier (error)
Punctuation (})
Comment (// proxy is used to suffle data from src to destination, and sends errors\n)
Comment (// down a dedicated channel\n)
KeywordFunc
Identifier (proxy)
Punctuation (()
Identifier (dst)
Identifier (io)
Operator (.)
Identifier (Writer)
Punctuation (,)
Identifier (src)
Identifier (io)
Operator (.)
Identifier (Reader)
Punctuation (,)
Identifier (errCh)
KeywordChan
Identifier (error)
Punctuation ())
Punctuation ({)
Identifier (_)
Punctuation (,)
Identifier (err)
Operator (:=)
Identifier (io)
Operator (.)
Identifier (Copy)
Punctuation (()
Identifier (dst)
Punctuation (,)
Identifier (src)
Punctuation ())
KeywordIf
Identifier (tcpConn)
Punctuation (,)
Identifier (ok)
Operator (:=)
Identifier (dst)
Operator (.)
Punctuation (()
Identifier (closeWriter)
Punctuation ())
Punctuation (;)
Identifier (ok)
Punctuation ({)
Identifier (tcpConn)
Operator (.)
Identifier (CloseWrite)
Punctuation (()
Punctuation ())
Punctuation (})
Identifier (errCh)
Operator (<-)
Identifier (err)
Punctuation (})
